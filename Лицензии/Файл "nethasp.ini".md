Основной конфигурационный файл для настройки поиска аппаратных (HASP) лицензий в 1С называется:

### **nethasp.ini**

Этот файл отвечает за то, как программа (клиент или сервер 1С) будет искать ключ защиты в сети.

---

### Где он находится?

В зависимости от операционной системы и версии платформы, пути могут быть следующими:

**На Windows:**
1.  **Общий для всех версий:** `C:\Program Files\1cv8\conf\nethasp.ini` (если его там нет, его можно создать или скопировать из папки `bin`).
2.  **В папке конкретной версии:** `C:\Program Files\1cv8\8.3.XX.XXXX\bin\conf\nethasp.ini`.

**На Linux:**

**Каталог conf конкретной версии, например: `/opt/1cv8/a.../<8.3.**.****>/conf`**
**Каталог conf корневого каталога установки: `/opt/1cv8/conf`**
**Каталог `~/.1cv8/1C/1cv8/conf` (~ ‑ домашний каталог пользователя, от имени которого работает клиентское приложение «1С:Предприятия»)**
**Каталог, который указан в файле conf.cfg, расположенном в каталоге conf установленной версии.**

---

### Зачем он нужен? (Типовые настройки)
В этом файле администраторы обычно прописывают конкретные IP-адреса серверов, на которых стоят USB-ключи, чтобы ускорить запуск 1С и избежать проблем с широковещательными (broadcast) запросами.
Опираясь на классическую структуру, давай разберем параметры с точки зрения **системного администратора 1С**.

---

### 1. Секция [NH_COMMON] (Общие настройки)
Здесь мы выбираем, какие «языки» (протоколы) будет использовать 1С для поиска ключа.

*   **`NH_TCPIP = <Status>` (ENABLED/DISABLED)**
    *   *Смысл:* Разрешить или запретить поиск ключа по сети через TCP/IP.
    *   *Совет:* В современных сетях это **единственный** параметр, который должен быть `ENABLED`.
*   **`NH_IPX` и `NH_NETBIOS`**
    *   *Смысл:* Старые протоколы из 90-х.
    *   *Совет:* Всегда ставь им **`DISABLED`**. Если они включены, 1С будет тратить время, пытаясь «докричаться» до ключа через них, ждать таймаута и только потом переходить к TCP/IP. Это главная причина тормозов при запуске.
*   **`NH_SESSION` и `NH_SEND_RCV`** (по умолчанию 2 секунды и 1 секунда соответственно) 
    *   *Смысл:* Лимиты сессий и таймауты пакетов.
    *   *Совет:* Обычно не трогаем. Имеет смысл менять `NH_SEND_RCV` (таймаут), только если у тебя очень плохой интернет-канал до удаленного сервера с ключом.

---

### 2. Секция [NH_TCPIP] (Самая важная)
Здесь мы настраиваем, **где именно** искать ключ.

*   **`NH_SERVER_ADDR = <Addr1>, <Addr2>...`**
    *   *Смысл:* Прямое указание IP-адресов серверов, где установлены USB-ключи и запущен **HASP License Manager**.
    *   *Почему это круто:* Это отключает «беготню» 1С по всей сети. Программа сразу идет по адресу. 
*   **`NH_PORT_NUMBER = <Port>`**
    *   *Смысл:* Порт, по которому работает ключ. По умолчанию **475**.
    *   *Совет:* Не меняй, если только твой отдел безопасности не заставил перенастроить порты. Не забудь открыть 475 порт (UDP и TCP) в фаерволе.
*   **`NH_TCPIP_METHOD = <Method>` (TCP или UDP)**
    *   *Смысл:* Как передавать пакеты. 
    *   *Совет:* По умолчанию используется **UDP** (быстрее для широковещания). Если ключ за тридевять земель и UDP-пакеты режутся, можно попробовать переключить на **TCP**.
*   **`NH_USE_BROADCAST = <Status>` (ENABLED/DISABLED)**
    *   *Смысл:* Использовать ли широковещательный запрос («кричать» на всю сеть: «У кого есть ключ?»).
    *   *Совет:* Если ты прописал `NH_SERVER_ADDR`, поставь здесь **`DISABLED`**. Это уберет лишний мусор из сети и ускорит вход в 1С.
*   **`NH_SERVER_NAME = <Name1>, <Name2>...`**
    *   *Смысл:* В данном параметре необходимо указывать НЕ сетевое имя сервера/хоста/кластера, а именно имя менеджера лицензий HASP LM, которое было вручную ему присвоено в конфигурационном файле nhsrv.ini с помощью параметра NHS_SERVERNAMES (например, NHS_SERVERNAMES=LM1).
    *   *Совет:* Рекомендуем с осторожностью подходить к использованию данного параметра, т.к. он имеет смысл только если в сети установлены несколько многопользовательских клиентских ключей HASP на разных ПК и то не во всех сценариях. Если же в сети доступен только один ключ, данный параметр ничего не даст, а возможно даже наоборот будет мешать его нормальной работе.

---

### 3. Секции [NH_IPX] и [NH_NETBIOS]
Параметры в этих секциях сегодня **не актуальны**. Если в первой секции ты поставил им `DISABLED`, эти разделы 1С просто проигнорирует.

---


аю устаревшие протоколы (IPX, NetBIOS) и широковещательные запросы, жестко прописывая IP-адреса менеджеров лицензий в параметре `NH_SERVER_ADDR`. Это позволяет избежать задержек при старте системы и гарантирует стабильное получение аппаратных лицензий в распределенных сетях».
